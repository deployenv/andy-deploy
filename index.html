<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DevopsAndy</title>
  <style>
    body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;line-height:1.4;padding:18px;background:#f7f7fb;color:#111}
    table{border-collapse:collapse;width:100%;max-width:860px;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 6px 18px rgba(20,20,40,0.06)}
    thead tr{background:#f0f4ff}
    th,td{padding:12px 14px;border-bottom:1px solid #eef2ff;text-align:left;font-size:14px}
    th:first-child,td:first-child{width:120px}
    /* 隐藏地址列的表头和单元格（同时保留数据作为 data- 属性） */
    .col-address{display:none}

    .btn-copy{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:6px;border:1px solid #d6def8;background:#fff;cursor:pointer}
    .btn-copy:active{transform:translateY(1px)}
    .toast{position:fixed;right:20px;bottom:20px;padding:10px 14px;background:#111;color:#fff;border-radius:8px;box-shadow:0 6px 20px rgba(0,0,0,0.12);opacity:0;pointer-events:none;transform:translateY(10px);transition:all .22s}
    .toast.show{opacity:1;pointer-events:auto;transform:translateY(0)}
    .muted{color:#6b7280;font-size:13px}
  </style>
</head>
<body>
  <h2>命令列表</h2>

  <table id="menuTable" aria-describedby="desc">
    <thead>
      <tr>
        <th>名称</th>
        <th class="col-address">地址</th>
        <th>描述</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <!-- 将地址存进 data-address，列本身保持隐藏 -->
      <tr data-address="bash &lt;(curl -sL devopsandy.hdyauto.qzz.io/menu/main)">
        <td>命令菜单</td>
        <td class="col-address">bash &lt;(curl -sL devopsandy.hdyauto.qzz.io/menu/main)</td>
        <td class="muted">展现所有操作</td>
        <td><button class="btn-copy" data-label="复制">复制</button></td>
      </tr>
      <!-- 可以按需继续添加更多行 -->
      <tr data-address="bash &lt;<(curl -sL devopsandy.hdyauto.qzz.io/devops.sh?$(openssl rand -base64 12 | tr -dc 'a-zA-Z0-9' | cut -c1-16)) setup_gitlab">
        <td>Gitlab服务器</td>
        <td class="col-address">bash &lt;(curl -sL devopsandy.hdyauto.qzz.io/devops.sh?$(openssl rand -base64 12 | tr -dc 'a-zA-Z0-9' | cut -c1-16)) setup_gitlab</td>
        <td class="muted">部署Gitlab及相关工具</td>
        <td><button class="btn-copy" data-label="复制">复制</button></td>
      </tr> 
      <tr data-address="bash &lt;<(curl -sL devopsandy.hdyauto.qzz.io/devops.sh?$(openssl rand -base64 12 | tr -dc 'a-zA-Z0-9' | cut -c1-16)) devops_desktop">
        <td>desktop服务器</td>
        <td class="col-address">bash &lt;(curl -sL devopsandy.hdyauto.qzz.io/devops.sh?$(openssl rand -base64 12 | tr -dc 'a-zA-Z0-9' | cut -c1-16)) devops_desktop</td>
        <td class="muted">部署远程服务器及相关工具</td>
        <td><button class="btn-copy" data-label="复制">复制</button></td>
      </tr>               
    </tbody>
  </table>

  <div id="toast" class="toast" role="status" aria-live="polite">已复制到剪贴板</div>

  <script>
    // 绑定表格的复制按钮
    document.querySelectorAll('.btn-copy').forEach(function(btn){
      btn.addEventListener('click', async function(e){
        var tr = btn.closest('tr');
        if(!tr) return;
        // 地址优先读取 data-address，如果没有再读取隐藏列文本作为回退
        var address = tr.getAttribute('data-address') || (tr.querySelector('.col-address') && tr.querySelector('.col-address').textContent.trim()) || '';
        if(!address){
          showToast('没有可复制的地址');
          return;
        }
        try{
          await navigator.clipboard.writeText(address);
          showToast('已复制：' + truncate(address, 60));
        }catch(err){
          // 兼容性回退（创建临时 textarea）
          fallbackCopyTextToClipboard(address);
          showToast('已复制（回退模式）：' + truncate(address, 60));
        }
      });
    });

    function fallbackCopyTextToClipboard(text) {
      var textArea = document.createElement('textarea');
      textArea.value = text;
      // 避免页面滚动到下方
      textArea.style.position = 'fixed';
      textArea.style.left = '-9999px';
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      try { document.execCommand('copy'); } catch (err) { }
      document.body.removeChild(textArea);
    }

    // 简短展示，避免 toast 过长
    function truncate(s, n){ return s.length > n ? s.slice(0,n-1) + '…' : s }

    // toast 提示
    var toastTimer = null;
    function showToast(text){
      var t = document.getElementById('toast');
      t.textContent = text;
      t.classList.add('show');
      if(toastTimer) clearTimeout(toastTimer);
      toastTimer = setTimeout(function(){ t.classList.remove('show'); }, 2200);
    }
  </script>
</body>
</html>
